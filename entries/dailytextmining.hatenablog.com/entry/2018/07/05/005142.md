---
Title: 2018/7/4【12日目】TF-IDF分析を理解する、まずは対数から
Category:
- 180日間テキストマイニング
Date: 2018-07-05T00:51:42+09:00
URL: https://dailytextmining.hatenablog.com/entry/2018/07/05/005142
EditURL: https://blog.hatena.ne.jp/rimt/dailytextmining.hatenablog.com/atom/entry/10257846132598128346
---

昨日の段階で一通りデータの保存、検索の土台ができました。そこで、ずっとやりたかったTF-IDF分析を始めていきたいと思います。

##TF-IDF分析とは
自然言語処理の本を見ているとよく出てきます。Webを見てみると初歩中初歩の分析だとか書かれてるくらいです。この分析をすると、ある文書中の単語の重要度がわかるそうです。

TF-IDF分析のWikipediaの解説を見てみます（Hatenaでの数式の書き方がわからなかったので、かなり見にくいです）。
> tf-idfは、文書中に含まれる単語の重要度を評価する手法の1つであり、主に情報検索やトピック分析などの分野で用いられている。
tf-idfは、tf（英: Term Frequency、単語の出現頻度）とidf（英: Inverse Document Frequency、逆文書頻度）の二つの指標に基づいて計算される。


なるほど、全くわからないですね。
数式で書くとこんな感じになるらしいです。

[f:id:rimt:20180705004346p:plain]

> n_ijは文書d_jにおける単語t_iの出現回数、Σ_nkjは文書d_jにおけるすべての単語の出現回数の和、|D|は総文書数、|{d:〜}|は単語t_iを含む文書数である。そのため、idfは一種の一般語フィルタとして働き、多くの文書に出現する語（一般的な語）は重要度が下がり、特定の文書にしか出現しない単語の重要度を上げる役割を果たす。

数1までしかやっていない文系にはとてもきつい。まずこのlogというのがよくわかっていないので、まずlogから調べてみます。

##logとは
まずは公式から。日本語でいうと対数というんですね。
```
a^x =b <-> x = log(a)b
```
例えば5x =25なんて数式があったら、x =log(5)25

それでこれで何を表しているのかと言うと、
ある決まった数を何回かけたか現す数
だそうです。

上の数の場合、5を何回かけたら25になるか、という問題。5x5 =25なので、x＝２になります。(a)のところを底と言って、bを真数と言うそうです。指数に変換すると次の式になります。
5^2 =25

これで何が便利なのかというと、大きい数をわかりやすくできるとのことです。有名なのが、マグニチュード。マグニチュードのエネルギーは次のように計算するようです。

log(10)E = 4.8 + 1.5M

指数にすると

E = 10^(4.8 + 1,5M)こんな感じ。M1の場合

↓

E = 10 x 4.8 x 10 x (1.5 x 1)

↓

E = 63.095 x 31.6(約32倍)
E =  1993.802
になるらしいです。エネルギーの数値が大きすぎるので（1993.802）、対数を使用しM1と表しているようです。

##tf-idfに戻る
もう一回例を考えながらWikiの公式を見てみます。
###tfの場合
データマイニングという言葉が1つの文書の中で5回でてきて、その文書における単語の数の和が1000だとsるとtfというのは5/1000で0.005になりますね。

###idfの場合
5点の文書があって、その5点の中にデータマイニングという言葉を含んでいる文書が2点ある、となるとidfはlog(a)2.5ですね。それでこのlogというのは、大きくなりすぎる数字を全体的に小さくする役割なので、底(a)はなんでもいいらしいです（1.5くらいにするといいらしいです）。ネットで見ただけの知識なので、そのうち論文でも見てみます。と、いうわけで底を1.5として計算すると2.26です。

###tf-idfの計算
tf-idfの式はtfとidfをかければいいだけの話なので、この場合tf-df分析でのデータマイニングの数値は0.0113です。
これだけだけ「なんのこっちゃ」という感じですが、この分析を行うと「その文書における、その単語の重要度」がわかるらしいです。つまり、重要なほどこの数値が高くなるそうです。

ここで終わるのも中途半端ですが、明日実装して色々確かめていきたいと思います。

##今日の結果
今日のつぶやき件数は42件でした。	
形容詞を見てみるとこんな感じです。
```
'嬉しい': 8, '楽しい': 5, 'すごい': 3, '良い': 3, '可愛い': 2, '凄い': 2, '面白い': 2, 'かわいい': 1, '高い': 1, 'いい': 1, 'くい': 1, '弱い': 1, '珍しい': 1, '多い': 1, '遅い': 1, 'ない': 1, '難しい': 1, '若い': 1
```
嬉しいというつぶやきが8件もあります、どうしたんですかね？パッと見た感じですが、番組に出れて嬉しいな、という発言ですね。下記のメンバーが発言しています。

- '912_komiharu'
- 'makiho_1019'
- 'o_megu1112'
- 'seina_fuku48'


##今日学んだこと
- tf-idf分析の考え方
- 対数の計算方法
